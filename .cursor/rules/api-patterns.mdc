---
description: when working on Youtube API related topics.
globs: 
alwaysApply: false
---
# YouTube API Patterns

## API Key Handling
```javascript
// Get API key from localStorage
const apiKey = localStorage.getItem('youtube_api_key');
if (!apiKey) {
  throw new Error('API key required');
}

// Validate API key format (39 characters)
const isValidKey = /^[A-Za-z0-9_-]{39}$/.test(apiKey);
```

## Core API Endpoints
```javascript
const API_BASE = 'https://www.googleapis.com/youtube/v3';

// Channel info
const channelUrl = `${API_BASE}/channels?part=snippet,statistics&id=${channelId}&key=${apiKey}`;

// Channel videos 
const videosUrl = `${API_BASE}/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=50&key=${apiKey}`;

// Video details
const detailsUrl = `${API_BASE}/videos?part=snippet,statistics&id=${videoIds}&key=${apiKey}`;
```

## Error Handling
```javascript
try {
  const response = await fetch(apiUrl);
  const data = await response.json();
  
  if (data.error) {
    throw new Error(`API Error: ${data.error.message}`);
  }
  
  return data;
} catch (error) {
  console.error('YouTube API failed:', error);
  throw error;
}
```

## Quota Management
- **Daily limit**: 10,000 units
- **Channel search**: ~100 units
- **Video details**: ~1 unit per video
- **Monitor usage** in YouTube API Console

## Demo Mode
Use predefined mock data when no API key available:
```javascript
const isDemoMode = !apiKey;
if (isDemoMode) {
  return loadMockData();
}
```

## Key Files
- [src/js/services/youtubeApi.js](mdc:src/js/services/youtubeApi.js) - Main API service
- [src/js/services/analytics.js](mdc:src/js/services/analytics.js) - Data processing
